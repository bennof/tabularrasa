!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.tr=e():t.tr=e()}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){t.exports=n(2)},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"popup",(function(){return p})),n.d(r,"error",(function(){return h})),n.d(r,"warning",(function(){return m})),n.d(r,"info",(function(){return g})),n.d(r,"log",(function(){return b}));var o={};n.r(o),n.d(o,"open",(function(){return v})),n.d(o,"read",(function(){return y})),n.d(o,"save",(function(){return w}));var a={};n.r(a),n.d(a,"header_map",(function(){return _})),n.d(a,"hash_map",(function(){return C})),n.d(a,"query_map",(function(){return A}));var i={};n.r(i),n.d(i,"json",(function(){return k})),n.d(i,"html",(function(){return R})),n.d(i,"data",(function(){return x})),n.d(i,"router",(function(){return T})),n.d(i,"tag",(function(){return j}));var s={};n.r(s),n.d(s,"fold",(function(){return I})),n.d(s,"map",(function(){return E})),n.d(s,"to_list",(function(){return N}));var c={};n.r(c),n.d(c,"init",(function(){return M})),n.d(c,"config",(function(){return $})),n.d(c,"store",(function(){return J})),n.d(c,"logged_in",(function(){return q})),n.d(c,"login",(function(){return H})),n.d(c,"logout",(function(){return P})),n.d(c,"refresh",(function(){return B})),n.d(c,"get",(function(){return F})),n.d(c,"post",(function(){return V})),n.d(c,"del",(function(){return G}));var u={};n.r(u),n.d(u,"get",(function(){return z})),n.d(u,"post",(function(){return K})),n.d(u,"remove",(function(){return W}));var d={};n.r(d),n.d(d,"get_user",(function(){return Q})),n.d(d,"get_group",(function(){return Y})),n.d(d,"get_groups",(function(){return Z})),n.d(d,"get_group_members",(function(){return tt})),n.d(d,"users",(function(){return nt})),n.d(d,"teams",(function(){return rt})),n.d(d,"mail",(function(){return ot})),n.d(d,"base64_enc",(function(){return it})),n.d(d,"toUTF8",(function(){return st}));var f={};n.r(f),n.d(f,"on",(function(){return ft}));var l={};n.r(l),n.d(l,"init",(function(){return ht})),n.d(l,"clear",(function(){return mt})),n.d(l,"cmp",(function(){return gt})),n.d(l,"add_colum",(function(){return bt})),n.d(l,"map",(function(){return vt})),n.d(l,"map3",(function(){return wt})),n.d(l,"fold",(function(){return _t})),n.d(l,"fold4",(function(){return Ct})),n.d(l,"filter",(function(){return St})),n.d(l,"select",(function(){return At})),n.d(l,"reduce",(function(){return kt})),n.d(l,"sort",(function(){return Rt})),n.d(l,"search_and_get",(function(){return xt})),n.d(l,"search",(function(){return Tt})),n.d(l,"binary_search",(function(){return jt})),n.d(l,"get_col",(function(){return Ot})),n.d(l,"get",(function(){return It})),n.d(l,"get_row_obj",(function(){return Et})),n.d(l,"add_obj",(function(){return Nt})),n.d(l,"add_obj_array",(function(){return Lt})),n.d(l,"read_csv",(function(){return Dt})),n.d(l,"write_csv",(function(){return Mt}));n(1);function p(t,e){var n=document.getElementById("popup_area");n||((n=document.createElement("div")).id="popup_area",document.body.appendChild(n));var r=document.createElement("div");r.className="popup",t instanceof Element||t instanceof HTMLDocument?r.appendChild(t):r.innerHTML=t,n.appendChild(r);window.setTimeout((function(){n.removeChild(r)}),e)}function h(t,e){p("<h1>"+t+"</h1><p>"+e+"</p>",5e3)}function m(t,e){p("<h1>"+t+"</h1><p>"+e+"</p>",5e3)}function g(t,e){p("<h1>"+t+"</h1><p>"+e+"</p>",5e3)}function b(t,e){p("<h1>"+t+"</h1><p>"+e+"</p>",5e3)}function v(t,e,n,r){if(null==t){var o=document.createElement("input");return o.setAttribute("type","file"),o.setAttribute("id","testfile"),e&&o.setAttribute("accept",e),o.addEventListener("change",function(){v(this.input.files,this.mime,this.cb,this.type)}.bind({input:o,mime:e,cb:n,type:r}),!1),void p(o,1e4)}if("Files"!=r)if(t.length)console.log("files_read"),function t(e,n,r,o,a,i){if(e.length<=n)return void a(200,o);var s=e[n],c=new FileReader;c.onload=function(){this.res.push({src:s.name,data:c.result}),t(this.files,this.i+1,this.mime,this.res,this.cb,this.Type)}.bind({files:e,i:n,mime:r,res:o,cb:a,type:i});c.onerror=function(){a(404,{src:s,error:c.error,data:o})};"DataURL"==i?c.readAsDataURL(s):c.readAsText(s)}(t,0,e,[],n,r);else{var a=new FileReader;a.onload=function(){n(200,a.result)},a.onerror=function(){n(404,a.error)},"DataURL"==r?a.readAsDataURL(t):a.readAsText(t)}else n(200,t)}function y(t,e,n){var r=new FileReader;r.cb=t,r.onload=function(t){this.cb(200,t.target.result)},r.onerror=function(t){this.cb(404,t.target.error.code)},"DataURL"==n?r.readAsDataURL(e):r.readAsText(e)}function w(t,e,n){var r=document.createElement("a");if(e.startsWith("text")?r.setAttribute("href","data:"+e+","+encodeURIComponent(n)):r.setAttribute("href","data:"+e+","+btoa(n)),r.setAttribute("download",t),document.createEvent){var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),r.dispatchEvent(o)}else r.click()}function _(t){var e,n,r,o,a={},i=t.getAllResponseHeaders().trim().split(/[\r\n]+/);for(e=0;e<i.length;e++)r=(n=i[e].split(": ")).shift(),o=n.join(": "),a[r]=o;return a}function C(t){var e,n,r={},o=t.hash.substr(1).split("&");for(e=0;e<o.length;e++)r[(n=o[e].split("="))[0]]=decodeURIComponent(n[1])||n[0];return r}function A(){var t,e,n={},r=URL.search.substr(1).split("&");for(t=0;t<r.length;t++)n[(e=r[t].split("="))[0]]=e[1]||e[0];return n}function k(t,e){x(t,(function(t){e(JSON.parse(t))}))}function R(t,e){x(t,(function(t){e.innerHTML=t,O(e,"clean-code"),e.querySelectorAll("SCRIPT").forEach((function(t){eval.call(window,t.innerText)}))}))}function x(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(t){4==n.readyState&&(200==n.status?e(n.responseText):console.log("Error: ("+n.status+")"))},n.open("GET",t,!0),n.send()}function T(t){var e=document.querySelector("["+t+"]"),n=C(window.location);n[t]?n[t]:e.getAttribute(t);R(SRC,e),window.onhashchange=function(){var n=C(window.location);R(n[t]?n[t]+".html":e.getAttribute(t),e)}}function j(t){var e,n,r=document.querySelectorAll("["+t+"]");for(e=0;e<r.length;e++)R((n=r[e]).getAttribute(t),n)}var U={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};var O=function(t){var e,n,r,o,a=t.querySelectorAll("[clean-code]");for(e=0;e<a.length;e++)n=a[e],o=n.innerHTML,r=String(o).replace(/[&<>"'\/]/g,(function(t){return U[t]})),n.innerHTML=r};function I(t,e,n){var r,o=Object.keys(n);for(r=0;r<o.length;r++)e=t(o[r],n[o[r]],e);return e}function E(t,e){var n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)r[o[n]]=t(o[n],e[o[n]]);return r}function N(t){var e,n=[],r=Object.keys(t);for(e=0;e<r.length;e++)n.push({key:r[e],value:t[r[e]]});return n}O(document);const L="tr_net_conf_";function M(t,e){var n,r;n=null!=(r=sessionStorage.getItem(L+t))?JSON.parse(r):null!=(n=localStorage.getItem(L+t))?JSON.parse(r):{name:t,state:1,store:null,conn:0,max_conn:-1,oauth:null,id:null,access_token:null,refresh_token:null},e&&(n=$(n,e));var o=C(window.location);if(o.access_token&&(n.access_token=o.access_token,n.state=0),o.id_token){var a=o.id_token.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),i=decodeURIComponent(atob(a).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));n.id=JSON.parse(i)}return o.state&&(n.resp_state=o.state,o.state==="hidden_redirect:"+n.name&&(console.log(location.protocol+"//"+location.host),console.log(o),o.access_token?window.parent.postMessage({state:"ok",access_token:o.access_token},location.protocol+"//"+location.host):window.parent.postMessage({state:"error",desc:"relogin"},location.protocol+"//"+location.host))),o.error&&(n.state=-1,n.error=o.error,n.error_desc=o.error_description),J(n,n.store),o.state&&(n.resp_state=o.state,o.state==="hidden_redirect:"+n.name&&(console.log(location.protocol+"//"+location.host),console.log(o),window.parent.postMessage(o.access_token,"http://localhost:8080")),o.state==="refresh:"+n.name&&(console.log("refresh"),function(t,e){var n=t.oauth.link;for(var r in t.oauth.param)n+=encodeURIComponent(r)+"="+encodeURIComponent(t.oauth.param[r])+"&";n+=encodeURIComponent("state")+"="+encodeURIComponent("hidden_redirect:"+t.name)+"&",n+=encodeURIComponent("prompt")+"="+encodeURIComponent("none")+"&",n+=encodeURIComponent("login_hint")+"="+encodeURIComponent(t.id.email),window.location.href=n}(n))),window.addEventListener("message",function(t){console.log("Event"),console.log(t.data),t.data.state&&("ok"===t.data.state?this.access_token=t.data.access_token:alert("login needed"));var e=document.getElementById("hidden_redirect_"+this.name);e&&e.parentElement.removeChild(e)}.bind(n),!1),n}function $(t,e){return"string"==typeof e&&(e=JSON.parse(e)),t.oauth={},t.oauth.link=e.link||null,t.oauth.param=e.param||{client_id:"",response_type:"",redirect_uri:"",scope:"",nonce:"",state:""},J(t,t.store),t}function J(t,e){switch(t.store=e,e){case"local":window.localStorage.setItem(L+t.name,JSON.stringify(t));break;case"session":window.sessionStorage.setItem(L+t.name,JSON.stringify(t))}}function q(t){return 0===OAuth.state}function H(t,e){t.store||J(t,"session");var n,r=document.createElement("form");for(var o in r.setAttribute("method","GET"),r.setAttribute("action",t.oauth.link),t.oauth.param)(n=document.createElement("input")).setAttribute("type","hidden"),n.setAttribute("name",o),n.setAttribute("value",t.oauth.param[o]),r.appendChild(n);(n=document.createElement("input")).setAttribute("type","hidden"),n.setAttribute("name","state"),n.setAttribute("value",e),r.appendChild(n),r.style.display="none",document.body.appendChild(r),r.submit()}function P(t){t.store&&("session"==t.store?window.sessionStorage.removeItem(L+t.name):window.localStorage.removeItem(L+t.name)),t.access_token=null,t.state=1,window.location.href="/"}function B(t){t.store||J(t,"session");t.oauth.link;for(var e in t.oauth.param)encodeURIComponent(e)+"="+encodeURIComponent(t.oauth.param[e])+"&";encodeURIComponent("state"),encodeURIComponent("hidden_redirect:"+t.name),encodeURIComponent("prompt"),encodeURIComponent("none"),encodeURIComponent("login_hint"),encodeURIComponent(t.id.email);var n=document.createElement("Iframe");n.id="hidden_redirect_"+t.name,n.style.display="none",n.src=location.protocol+"//"+location.host+"/#state=refresh:"+t.name,document.body.appendChild(n)}function F(t,e,n,r,o){return X(t,e,"GET",n,null,r,o)}function V(t,e,n,r,o,a){return X(t,e,"POST",n,r,o,a)}function G(t,e,n,r,o){return X(t,e,"DELETE",n,null,r,o)}function X(t,e,n,r,o,a,i){var s=new XMLHttpRequest;return s.open(n,r,!0),e.access_token&&s.setRequestHeader("Authorization","Bearer "+e.access_token),E(s.setRequestHeader.bind(s),i),a&&(s.responseType=a),s.fun=t,s.onreadystatechange=function(){if(4===s.readyState){var t=_(s);e.conn--,s.fun(s.status,s.response,t)}},e.conn++,o?s.send(o):s.send(),s}function z(t,e,n,r,o){F(o,t,e,n,r)}function K(t,e,n,r,o,a){V(a,t,e,o,n,r)}function W(t,e,n,r,o){G(o,t,e,n,r)}function Q(t,e,n){z(t,"https://graph.microsoft.com/beta/"+e,"json",[],n)}function Y(t,e,n){z(t,"https://graph.microsoft.com/beta/groups/"+e,"json",[],n)}function Z(t,e){z(t,"https://graph.microsoft.com/beta/groups/","json",[],e)}function tt(t,e,n){z(t,"https://graph.microsoft.com/beta/groups/"+e+"/members","json",[],n)}function et(t,e){200===t?(this.data=this.data?this.data.concat(e.value):e.value,e["@odata.nextLink"]?z(this.oauth,e["@odata.nextLink"],"json",[],et.bind(this)):this.cb(t,this.data)):this.cb(t,this.data?this.data:[])}var nt={get:function(t,e,n){z(t,"https://graph.microsoft.com/beta/"+e,"json",[],n)},list:function(t,e){z(t,"https://graph.microsoft.com/beta/users/?$select=id,displayName,givenName,surname,mail","json",[],et.bind({oauth:t,cb:e}))},list_by_group:function(t,e,n){rt.get_gid(t,e,function(e,n){200===e&&z(t,"https://graph.microsoft.com/beta/groups/"+n+"/members/?$select=id,displayName,givenName,surname,mail","json",[],et.bind(this))}.bind({oauth:t,cb:n}))},search:function(t,e,n){z(t,"https://graph.microsoft.com/beta/users?$filter="+I((function(t,e,n){return n+t+"+eq+'"+e+"'+and+"}),"",e).slice(0,-5)+"&$select=id,displayname","json",[],function(t,n){200===t&&n.value.length>0?1===n.value.length?this.cb(t,n.value[0].id):this.cb(300,n.value):(t=I((function(t,e,n){return n+"startswith("+t+",'"+e+"')+and+"}),"",e).slice(0,-5),console.log(t),z(this.oauth,"https://graph.microsoft.com/beta/users?$filter="+t+"&$select=id,displayname","json",[],function(t,e){200===t&&e.value.length>0?1===e.value.length?this.cb(t,e.value[0].id):this.cb(300,e.value):this.cb(200===t?404:t,e)}.bind(this)))}.bind({oauth:t,cb:n}))}},rt={create:function(t,e,n){var r={"template@odata.bind":"https://graph.microsoft.com/beta/teamsTemplates('"+(e.template||"standard")+"')",displayName:e.name,description:e.desc||"Auto Gen",memberSettings:{allowCreateUpdateChannels:!1,allowDeleteChannels:!1,allowAddRemoveApps:!1,allowCreateUpdateRemoveTabs:!1,allowCreateUpdateRemoveConnectors:!1},messagingSettings:{allowUserEditMessages:!0,allowUserDeleteMessages:!1},funSettings:{allowGiphy:!0,giphyContentRating:"strict"}};if(e.owners){var o,a=[];for(o=0;o<e.owners.length;o++)a.push("https://graph.microsoft.com/beta/users('"+e.owners[o]+"')");r["owners@odata.bind"]=a}rt.get_gid(t,e.name,function(t,n){200!=t?(console.log("Create Team: "+e.name),K(this.oauth,"https://graph.microsoft.com/beta/teams","",{"Content-Type":"application/json"},JSON.stringify(this.conf),function(t,e,n){202===t?this.cb(t,/(?:')([^']*)/.exec(n.location)[1]):this.cb(t,e)}.bind(this))):this.cb(409,n)}.bind({oauth:t,cb:n,conf:r}))},get_gid:function(t,e,n){rt.get(t,e,function(t,n){200===t&&n&&1===n.value.length&&n.value[0].id===e?this.cb(t,e):z(this.oauth,"https://graph.microsoft.com/beta/groups?$filter=startswith(displayName,'"+e+"')+or+startswith(mail,'"+e+"')&$select=id,displayname","json",[],function(t,e){200===t?1===e.value.length?this.cb(t,e.value[0].id):e.value.length>1?this.cb(300,e.value):this.cb(404,e):this.cb(t,e)}.bind(this))}.bind({oauth:t,cb:n}))},get:function(t,e,n){z(t,"https://graph.microsoft.com/beta/groups/"+e+"/?$select=id,displayname","json",[],n)},add_member:function(t,e,n,r){K(t,"https://graph.microsoft.com/beta/groups/"+e+"/members/$ref","",{"Content-Type":"application/json"},JSON.stringify({"@odata.id":"https://graph.microsoft.com/beta/users/"+n}),r)},rm_member:function(t,e,n,r){W(t,"https://graph.microsoft.com/beta/groups/"+e+"/members/"+n+"/$ref","",{},r)},add_owner:function(t,e,n,r){K(t,"https://graph.microsoft.com/beta/groups/"+e+"/owners/$ref","",{"Content-Type":"application/json"},JSON.stringify({"@odata.id":"https://graph.microsoft.com/beta/users/"+n}),r)},rm_owner:function(t,e,n,r){W(t,"https://graph.microsoft.com/beta/groups/"+e+"/owners/"+n+"/$ref","",{},r)},remove:function(t,e,n){W(t,"https://graph.microsoft.com/beta/groups/"+e,"",{},n)},list_members:function(t,e,n){z(t,"https://graph.microsoft.com/beta/groups/"+D+"/members/?$select=id,displayName,givenName,surname,mail","json",[],et.bind({oauth:t,cb:n}))},list_owners:function(t,e,n){z(t,"https://graph.microsoft.com/beta/groups/"+D+"/owners/?$select=id,displayName,givenName,surname,mail","json",[],et.bind({oauth:t,cb:n}))},list_all:function(t,e){z(t,"https://graph.microsoft.com/beta/groups/?$select=id,displayname,createdDateTime,expirationDateTime","json",[],et.bind({oauth:t,cb:e}))},list:function(t,e){z(t,"https://graph.microsoft.com/beta/groups/?$select=id,displayname,createdDateTime,expirationDateTime&$filter=groupTypes/any(c:c+eq+'Unified')","json",[],et.bind({oauth:t,cb:e}))}},ot={send:function(t,e,n,r,o){var a={message:{subject:n,importance:"High",body:{contentType:"Text",content:r},toRecipients:[],attachments:[]}};if("string"==typeof e)a.message.toRecipients.push({emailAddress:{address:e}});else for(var i=0;i<e.length;i++)a.message.toRecipients.push({emailAddress:{address:e[i]}});if(o)if("string"==typeof o)a.message.attachments.push({"@odata.type":"microsoft.graph.fileAttachment",name:o.name,contentType:o.mime,contentBytes:atob(st(o.body))});else for(i=0;i<o.length;i++)a.message.attachments.push({"@odata.type":"microsoft.graph.fileAttachment",name:o[i].name,contentType:o[i].mime,contentBytes:it(st(o[i].body))});console.log(a),K(OAuth,"https://graph.microsoft.com/beta/me/sendMail","",{"Content-Type":"application/json"},JSON.stringify(a),(function(t,e){console.log(t),console.log(e)}))}};const at="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function it(t){for(var e,n,r,o,a,i,s,c=0,u="";c<t.length;)o=(e=t[c++])>>2,a=(3&e)<<4|(n=t[c++])>>4,i=(15&n)<<2|(r=t[c++])>>6,s=63&r,isNaN(n)?i=s=64:isNaN(r)&&(s=64),u=u+at.charAt(o)+at.charAt(a)+at.charAt(i)+at.charAt(s);return u}function st(t){var e,n=[];for(e=0;e<t.length;e++){var r;(r=t.charCodeAt(e))<128?n.push(r):r<2048?n.push(192|r>>6,128|63&r):r<55296||r>=57344?n.push(224|r>>12,128|r>>6&63,128|63&r):(e++,r=(1023&r)<<10|1023&t.charCodeAt(e),n.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return n}var ct=!1,ut=[],dt=!1;function ft(t,e){if("function"!=typeof callback)throw new TypeError("callback for Ready(fn) must be a function");ct?setTimeout((function(){t(e)}),1):(ut.push({func:t,ctx:e}),"complete"===document.readyState?setTimeout(pt,1):dt||(document.addEventListener?(document.addEventListener("DOMContentLoaded",pt,!1),window.addEventListener("load",pt,!1)):(document.attachEvent("onreadystatechange",lt),window.attachEvent("onload",pt)),dt=!0))}function lt(){"complete"===document.readyState&&pt()}function pt(){if(!ct){ct=!0;for(var t=0;t<ut.length;t++)ut[t].func.call(window,ut[t].ctx);ut=[]}}function ht(t,e){return{state:0,name:t,header:e||[],data:[],sorted:-1}}function mt(t){return t.data=[],t}var gt={number:function(t,e){return t-e},string:function(t,e){return t.localeCompare(e)},any:function(t,e){return t.toString().localeCompare(e.toString())}};function bt(t,e,n){t.header.push(e);for(var r=t.header.length-1,o=0;o<t.data.length;o++)n&&n[o]?t.data[o][r]=n[o]:t.data[o][r]=null;return t}function vt(t,e){var n,r=e.data;for(n=0;n<r.length;n++)r[n]=t(r[n],n)}function yt(t,e){var n,r=[];for(n=0;n<e.length;n++)r[n]=t(e[n],n);return r}function wt(t,e,n){var r,o,a=n.data,i=yt((function(t){return"string"==typeof t?Ot(n,t):t}),e);for(r=0;r<a.length;r++)o=yt(function(t){return this[t]}.bind(a[r]),i),a[r]=t.apply(null,[a[r]].concat(o))}function _t(t,e,n){var r,o=n.data;for(r=0;r<Keys.length;r++)e=t(o[r],e);return e}function Ct(t,e,n,r){var o,a,i=r.data,s=yt((function(t){return"string"==typeof t?Ot(r,t):t}),n);for(o=0;o<i.length;o++)(a=yt(function(t){return this[t]}.bind(i[o]),s)).push(e),e=t.apply(null,a);return e}function St(t,e,n,r){var o,a="string"==typeof n?e.header.indexOf(n):n,i=ht(e.name+" filter",e.header.slice(0)),s=e.data;if(n)for(o=0;o<s.length;o++)0==t(s[o][a],r)&&i.data.push(s[o]);else for(o=0;o<s.length;o++)0==t(s[o],r)&&i.data.push(s[o]);return i}function At(t,e,n,r){var o,a,i,s=e.data,c=yt((function(t){return"string"==typeof t?Ot(e,t):t}),n),u=ht(e.name+" filter",yt((function(t){return e.header[t]}),c));for(o=0;o<s.length;o++)(a=yt(function(t){return this[t]}.bind(s[o]),c)).push(r),(i=t.apply(null,a))&&u.data.push(i);return u}function kt(t,e,n){var r="string"==typeof e?n.header.indexOf(e):e;n.sorted&&n.sorted==r||Rt(t,r,n);var o,a=n.data,i=a[0][r],s=ht(n.name+" reduce "+e,n.header.slice(0));for(s.data.push(a[0]),o=1;o<a.length;o++)0!=t(a[o][r],i)&&s.data.push(a[o]),i=a[o][r];return s}function Rt(t,e,n){var r="string"==typeof e?n.header.indexOf(e):e;return n.data=n.data.sort(function(t,e){return this.cmp(t[this.idx],e[this.idx])}.bind({idx:r,cmp:t})),n.sorted=r,r}function xt(t,e,n,r,o){var a=Tt(t,e,n,o);if(a>=0){var i="string"==typeof r?o.header.indexOf(r):r;return o.data[a][i]}}function Tt(t,e,n,r){var o;if(o="string"==typeof n?r.header.indexOf(n):n,r.sorted&&r.sorted==o)return Ut(t,e,o,r);var a,i=r.data;for(a=0;a<i.length;a++)if(0==t(i[a][o],e))return a;return-1}function jt(t,e,n,r){var o="string"==typeof n?r.header.indexOf(n):n;return r.sorted&&r.sorted==o||Rt(t,o,r),Ut(t,e,o,r)}function Ut(t,e,n,r){for(var o,a,i=0,s=r.data.length-1,c=r.data;i<=s;){if(o=i+(s-i)/2,console.log(e,c[o]),0==(a=t(e,c[o][n])))return o;a<0?s=o-1:i=o+1}return-1}function Ot(t,e){return t.header.indexOf(e)}function It(t,e,n){return typeof n==String&&(n=t.header.indexOf(n)),t.data[e][n]}function Et(t,e){for(var n={},r=0;r<t.header.length;r++)n[t.header[r]]=t.data[e][r];return n}function Nt(t,e,n){var r=Object.keys(e);n?typeof n==String&&(n=t.header.indexOf(n)):(n=t.data.length,t.data.push(new Array));for(var o=0;o<r.length;o++){var a=t.header.indexOf(r[o]);-1==a?console.log("TR_Table: Missing key: "+r[o]):t.data[n][a]=e[r[o]]}return t}function Lt(t,e){var n,r,o,a,i;for(n=0;n<e.length;n++){for(o=new Array,a=Object.keys(e[n]),r=0;r<a.length;r++)(i=t.header.indexOf(a[r]))>=0&&(o[i]=e[n][a[r]]);t.data.push(o)}return t}function Dt(t,e,n,r){"string"==typeof t&&(t=ht(t));var o,a,i="",s="",c=[""],u=0,d=0,f=!0,l=!r||0;for(t.data.push(c),a=0;a<e.length;a++)'"'===(o=e[a])?(f&&o===i&&(s+=o),f=!f):n===o&&f?(l?t.header[u++]=s:c[u++]=s,o=s=""):"\n"===o&&f?("\r"===i&&(s=s.slice(0,-1)),l?(l=!l,t.header[u]=s,o=s=""):(c[u]=s,t.data[++d]=c=[]),o=s="",u=0):s+=o,i=o;return 0!=u&&(c[u]=s),c.length!=t.header.length&&t.data.pop(),t}function Mt(t,e){var n,r="";if(t.header){for(var o=0;o<t.header.length;o++)o>0&&(r+=e),r+=$t(t.header[o],e);r+="\r\n"}for(o=0;o<t.data.length;o++){n=t.data[o];for(var a=0;a<n.length;a++)a>0&&(r+=e),r+=$t(n[a],e);r+="\r\n"}return r}function $t(t,e){var n,r="",o=!1;if(!t)return"";for(var a=0;a<t.length;a++)'"'==(n=t[a])?(r+=n,r+=n,o=!0):"\n"==n||"\r"==n||n==e?(r+=n,o=!0):r+=n;return o?'"'+r+'"':r}const Jt=4096,qt=0,Ht=1,Pt=[134,251,236,55,93,68,156,250,198,94,40,230,19,182,138,96,84,148],Bt=[27322,14316,54625,64156,53242,58920,10031,24714,1384,13947,58313,45535,25931,17171,16115,13233,61448,23417,9390,10876];function Ft(t){if(null==t.target.error){this.offset+=t.target.result.byteLength;var e=new DataView(t.target.result);switch(e.getInt16(0,!0)){case 256:!function(t,e){var n=new DataView(e),r=new ArrayBuffer(40);new DataView(r);switch(n.getInt32(20,!0)){case qt:var o="";for(i=0;i<18;i++)a=n.getUint8(68,!0)^Pt[i],o+=String.fromCharCode(a);t.version="Jet3",t.pwd=o;break;case Ht:o="";var a,i,s=n.getInt16(102,!0)^Bt[18];for(i=0;i<18;i++)(a=n.getUint16(66+2*i,!0)^Bt[i])>255&&(a^=s),o+=String.fromCharCode(a);t.version="Jet4",t.pwd=o,t.cipher=Xt.gen_key(t.pwd);break;default:Vt(t,"Unkown Version: "+n.getInt32(20,!0)),console.log("Unkown Version",n.getInt32(20,!0))}t.state=0}(this,t.target.result);break;case 257:n=this,t.target.result,n.state=0;break;case 258:!function(t,e){t.state=0}(this,t.target.result);break;default:return Vt(this,"Unkown Page: "+e.getInt32(0,!0)),void console.log("Unkown Page: ",e.getInt32(0,!0))}}else Vt(this,t.target.error);var n}function Vt(t,e){console.log("Read error: "+e),t.state=-1,t.error=e}function Gt(t,e){var n={name:t,state:1,file:e,offset:0};return function(t,e,n,r){var o=new FileReader,a=t.slice(e,n+e);o.onload=r,o.readAsArrayBuffer(a)}(e,0,Jt,Ft.bind(n)),n}var Xt={gen_key:function(t){var e,n,r=0,o=[],a=t.length;for(e=0;e<256;e++)o[e]=e;for(e=0;e<256;e++)r=(r+o[e]+t.charCodeAt(e%a))%256,n=o[e],o[e]=o[r],o[r]=n;return o},encode:function(t,e){var n,r,o=t.slice(0),a=new Uint8Array(e),i=0,s=0,c=a.length;for(n=0;n<c;n++)s=(s+o[i=(i+1)%256])%256,r=S[i],S[i]=S[s],S[s]=r,a[n]=a[n]^S[(S[i]+S[s])%256];return e}};function zt(t){v(null,"application/x-msaccess",(function(e,n){200===e?window[t]=Gt(t,n[0]):console.log(e,n)}),"Files")}function Kt(t){v(null,"text/csv",(function(e,n){200===e?window[t]=Dt(t,n[0].data,";"):console.log(e,n)}))}function Wt(t,e){save(t,"text/csv",Mt(e,";"))}n.d(e,"loadMDB",(function(){return zt})),n.d(e,"loadCSV",(function(){return Kt})),n.d(e,"saveCSV",(function(){return Wt})),n.d(e,"io",(function(){return o})),n.d(e,"loader",(function(){return i})),n.d(e,"maps",(function(){return s})),n.d(e,"net",(function(){return c})),n.d(e,"o365",(function(){return d})),n.d(e,"oauth",(function(){return u})),n.d(e,"pready",(function(){return f})),n.d(e,"popup",(function(){return r})),n.d(e,"table",(function(){return l})),n.d(e,"url",(function(){return a}))}])}));
//# sourceMappingURL=tabularrasa.js.map